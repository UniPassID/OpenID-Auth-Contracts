# OpenID-Auth-Contracts

This repo contains contracts for on-chain verification of OpenID IdTokens, and the contract verification supports both direct verification and verification wrapped in zero-knowledge proof, which hide the "sub", the user's identifier.

#### Prerequisite: 
Before on-chain verification, you need to create relevant environment values and hashes. Check out this repo [UniPass-OpenID-Auth](https://github.com/UniPassID/UniPass-OpenID-Auth) for verification vaule generation.

#### Testing:
For testing, you should set environment variables as below and run `forge test -vvvv --gas-report`.

```sh
TIMESTAMP=1694682092
SRS_HASH=0xb80b3409e0da2ef147dea3001facca17cb58bb3f703333750e9edc3e5096105d
NUM_INPUTS=1
DOMAIN_SIZE=524288
VK_DATA=0x000000312260e724844bca5251829353968e4915305258418357473a5c1d597f613f6cbd0379ab1710d5a86fdc9344684fd2cb17519f741244e76fe3de5bf503b3b6f31128926ef403c715afe64ea34b067802b959a3d229f215596205db85c75db6186023a223f3f33e123002bc89acb0cbf57dbb7785276db4275a7ea695a94958c2042c37a7384246d765713e91b67b7801db295676fde5c315460cd60e6e0bef89960113185d5bb618343c6c6c46963963d2352c90bf13f1057c2bd4d184160cd027287558c9ebf40cfd26e5222fefe897c982303fe97266a9f16b2d59a07878a782236b82ea9fcc4e1c5b3601af039d9fa3f3c52e86298dd78f8bdf5a048a66349a302b87a6bee819c81c5bbb57112a8dd6c91f662f4e01fbefa917d9d30c7560b63041a465e29140f7de6f26e70e077161b3f494bc165c3f806542c398fb619bc51ccc11e9917b2805b66a39feb05f5973f50a5bc71c814c1f00f5dcd73a3a1a6c2290a12f9230002937b400d180f951f014a2e18163a11130aeec05db83641ac507a85ecd02e5c799192537b737bd54f556c184067c3647e1526609af15abbeda113dc255d41cf20718eea9096ab4c4aba22af3bb799114634e69dd3f94d515ec2dd6518cd4f8c04b9941fc52e466dd08ca6963db035e1ab1ed3cb69f62d2045b261b26023c1d08bb84bd7da0f1b1584d6a1d49664074099efb5318f83a1899862610641b05d0b3e43c636a54da659f19e6507ef49fe3b7ceaac5fb4b03b871b803ae81834e822bfe58ddf853824a6646c3be16f4542bc11fe17bf0fd558e33610a7c6b71186cb30f7665130b05f9baa283ece42aa7fd7d2eef58565b14db247b15524702a4e36a8c3828c6543c057e095717d9bbd010932537c26edd2aecfaba1a59a27b7090480cf14c2ac2186d410673ac396abab5b94b20dc8a801892b27221eb6b2238e4dd9adc4c0526b269366452a299148f9701375ab7debcc750fd2f1294ec041c407336220bd5084866f028999edc39bd636af9c3dcf8cc0d055a5223db925e6dc4b1a1d4074ea4f77af001f841713729cbffa680e6267a6d88752b29a11191a937a5d0689aef3a88a19580c87ee354ae0af34dd526c829b9ced34f28f7b4e8cbe8f697cf16a07b770bcf81ec105a9384efff269501857ae2d0e50a2f7b35e5c6e4282394193cf00adb6537849c9f66d73c9d25617de26a722b9ac6232419cee2d483d2d9cc08e682affdb195eea1fc79eb36d39c0f1594fbfba54f2d052ff297ccd0d96f0e908040046f4941d7d2acd2b9c4f902f6da3221e989012e41b6f2fc92adeb10e3a697c158da5395387be6526c0ff7ca04c04d43a7972e1e6a029bc3212703bd9123aa8106dd1e742dfa005746b1ed80dfeb022750bea12db90a06d82fea422fe2e09e00f893a746f45a92939a5df0f94512f9645de85407512457f9cd54f15a143ad8a94f2a9a53155b378643dd2000fb7fc80ea5eec92b31d080bac0a9be5d131031c106a8a499da57ed20d5e3d64e1857de391898d41ad750f97860d9c04ebfc73ca83ebd649cc0f490fc6c7d46cf12d66120acb42600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003034c3ceef390becb7aa5e37a58325e62ea2439fdb5ad44cc4404ce0b66c3015223be5e43373a32524c88dacd5538bb843c8f9377b54fedff02d05da222e90111dbe9e35a66b567e5e0ce048d681ba11345efa88019ba1b5c689db0c980639b815df2283167def7d9fd31d79dfb506c924f593d6b0323e73b4d64b41264948b80984748b6a253d157daa405be779ec1032e5b2236f0a8e19e424fa3c2993568d19a1e40e6aadacf7f8a38c6855773e0ba1d5b0fae03d12ecea7740cc7297d95b24b58e733266126e350021017fffed7a15feaaeceeef56611535d45041db2bf90b4a98fd44f8fa74369d6d01a4cc04b4b1a28a2bc807034ce0afe80b42b97c7d202fa97238bac3d10abf6b48c8844c71b7d4bbfa0e04459b577b9d2ea32e3513160ecc910399f9f810164a62c0b7e7a8cb97f535096d56934f322bb5232dea29
OPENID_ISSUER=https://accounts.google.com
OPENID_KID=7c0b6913fe13820a333399ace426e70535a9a0bf
OPENID_PUB_KEY=0x9565d8d173a3fe291220322f18e85fb91850240023e815ac6db67a3fe3d745c973577dbe40b0781991cf3dc1f7ecba2ee6942c4d03ef4c44c07c22e782521149b3fcc75cc0e6d51a911966e5188617891c5a1e64eb4c7cbb452c971f9de84b9e2ae63e28b1d4543b8c50b9479180127087589d7cfe0a7afa3c5663f1141ecf374f54f1f9dd0f1afd9f5bfafa46cec312e60b332136feef63903689288d774f55cb65e56cd2c7e26759b2713e2c07c7f7525a09939f2898ad92eaaea7da9a919dae869a9ad217cb45bc0807b4b82a9c0f52ee9e97d7f90f910f52327319c46974ae50a84d842731b475aba33132783db76636b65a572f1dd62e4f3cabbebbd2f5
OPENID_AUDIENCE=407408718192.apps.googleusercontent.com
OPENIDZK_VERIFY_DATA=0x0000000800000023000000160000003e0000008c000000a10000005c00000083000000cf000000f4000001050000006600000067000001ac95c4c3238ca71d35d3675290016e014cf13410e4aa92ac5d6bc3d3041eb3dffeb6e2de64b7d2d18e73792bb430613c88485bec21c4024e6a09afd52d9ce64922000000000000000000000000000800000000004c7b22616c67223a225253323536222c226b6964223a2237633062363931336665313338323061333333333939616365343236653730353335613961306266222c22747970223a224a5754227d000001417b22697373223a2268747470733a2f2f6163636f756e74732e676f6f676c652e636f6d222c22617a70223a223430373430383731383139322e617070732e676f6f676c6575736572636f6e74656e742e636f6d222c22617564223a223430373430383731383139322e617070732e676f6f676c6575736572636f6e74656e742e636f6d222c22737562223a22000000000000000000000000000000000000000000222c2261745f68617368223a22764a7665746b52647878656d4c4c3736355f64325877222c226e6f6e6365223a226e2d3053365f577a41324d6a222c226e6266223a313639343637383139332c22696174223a313639343637383439332c22657870223a313639343638323039332c226a7469223a2231393566366237616531383132616534616364343462653033313562343534376239393230323333227d000001000680b76fb443cbb2533c7d94aab0db30269081a4e3c2be462f0c95559e949e19f7da6548f84493eee3a2ad721be21d96e5ee40f14c346d2917cbbb41dc1c8257940dcaf47c77b766d322a8e778c6cb01a0bcab6b0d1ac31d774e0bbbe61bfcbcf08e6478a48eb1893a633a3b687c68ca766081a976e288a7a81083764917c363fabf952e2482b50760c902c6f3b01863bd1be580c2694eb693cf76f859fa7b2826507ebd49ea0470f7ef617962549b06db5dd3ac486c66191f4a3541ff726c0f5c7bc6f16506d04367e5636e84175bcf59574f715b3a41b5312359ec8f75bdfb2764c6ebef53dac1cdfa94d06afd37d4e1436127c8b57511febe28bb4a5ca1a5000000312260e724844bca5251829353968e4915305258418357473a5c1d597f613f6cbd0379ab1710d5a86fdc9344684fd2cb17519f741244e76fe3de5bf503b3b6f31128926ef403c715afe64ea34b067802b959a3d229f215596205db85c75db6186023a223f3f33e123002bc89acb0cbf57dbb7785276db4275a7ea695a94958c2042c37a7384246d765713e91b67b7801db295676fde5c315460cd60e6e0bef89960113185d5bb618343c6c6c46963963d2352c90bf13f1057c2bd4d184160cd027287558c9ebf40cfd26e5222fefe897c982303fe97266a9f16b2d59a07878a782236b82ea9fcc4e1c5b3601af039d9fa3f3c52e86298dd78f8bdf5a048a66349a302b87a6bee819c81c5bbb57112a8dd6c91f662f4e01fbefa917d9d30c7560b63041a465e29140f7de6f26e70e077161b3f494bc165c3f806542c398fb619bc51ccc11e9917b2805b66a39feb05f5973f50a5bc71c814c1f00f5dcd73a3a1a6c2290a12f9230002937b400d180f951f014a2e18163a11130aeec05db83641ac507a85ecd02e5c799192537b737bd54f556c184067c3647e1526609af15abbeda113dc255d41cf20718eea9096ab4c4aba22af3bb799114634e69dd3f94d515ec2dd6518cd4f8c04b9941fc52e466dd08ca6963db035e1ab1ed3cb69f62d2045b261b26023c1d08bb84bd7da0f1b1584d6a1d49664074099efb5318f83a1899862610641b05d0b3e43c636a54da659f19e6507ef49fe3b7ceaac5fb4b03b871b803ae81834e822bfe58ddf853824a6646c3be16f4542bc11fe17bf0fd558e33610a7c6b71186cb30f7665130b05f9baa283ece42aa7fd7d2eef58565b14db247b15524702a4e36a8c3828c6543c057e095717d9bbd010932537c26edd2aecfaba1a59a27b7090480cf14c2ac2186d410673ac396abab5b94b20dc8a801892b27221eb6b2238e4dd9adc4c0526b269366452a299148f9701375ab7debcc750fd2f1294ec041c407336220bd5084866f028999edc39bd636af9c3dcf8cc0d055a5223db925e6dc4b1a1d4074ea4f77af001f841713729cbffa680e6267a6d88752b29a11191a937a5d0689aef3a88a19580c87ee354ae0af34dd526c829b9ced34f28f7b4e8cbe8f697cf16a07b770bcf81ec105a9384efff269501857ae2d0e50a2f7b35e5c6e4282394193cf00adb6537849c9f66d73c9d25617de26a722b9ac6232419cee2d483d2d9cc08e682affdb195eea1fc79eb36d39c0f1594fbfba54f2d052ff297ccd0d96f0e908040046f4941d7d2acd2b9c4f902f6da3221e989012e41b6f2fc92adeb10e3a697c158da5395387be6526c0ff7ca04c04d43a7972e1e6a029bc3212703bd9123aa8106dd1e742dfa005746b1ed80dfeb022750bea12db90a06d82fea422fe2e09e00f893a746f45a92939a5df0f94512f9645de85407512457f9cd54f15a143ad8a94f2a9a53155b378643dd2000fb7fc80ea5eec92b31d080bac0a9be5d131031c106a8a499da57ed20d5e3d64e1857de391898d41ad750f97860d9c04ebfc73ca83ebd649cc0f490fc6c7d46cf12d66120acb42600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003034c3ceef390becb7aa5e37a58325e62ea2439fdb5ad44cc4404ce0b66c3015223be5e43373a32524c88dacd5538bb843c8f9377b54fedff02d05da222e90111dbe9e35a66b567e5e0ce048d681ba11345efa88019ba1b5c689db0c980639b815df2283167def7d9fd31d79dfb506c924f593d6b0323e73b4d64b41264948b80984748b6a253d157daa405be779ec1032e5b2236f0a8e19e424fa3c2993568d19a1e40e6aadacf7f8a38c6855773e0ba1d5b0fae03d12ecea7740cc7297d95b24b58e733266126e350021017fffed7a15feaaeceeef56611535d45041db2bf90b4a98fd44f8fa74369d6d01a4cc04b4b1a28a2bc807034ce0afe80b42b97c7d202fa97238bac3d10abf6b48c8844c71b7d4bbfa0e04459b577b9d2ea32e3513160ecc910399f9f810164a62c0b7e7a8cb97f535096d56934f322bb5232dea29000000011de06a4118f7b2fbf4a28ffc8ea85413b07796acfa5742cd523edae028fdc7ac0000003513317b0295f3e70eee51b5e0156eb5db277eb9b3fd36b302bcae2b991f6e85f6214e552676a600683fec98f717f4e98ccbdf6cb1cfc66a476a3de608731623031b2cda9920ebb2b27550f8de9cdec6011ccc89ba4b5e16e7620db44033aef479068f0f0b39439e31934a13d7f69d299e9ed6b1852c7e59ea81aefb95eb613991075f2d44fc4f314cdd412a2adc1da3d1820a9b8f5d0024bade50a343f80576b712e39d1e38bedaee7cc23e89d1622ae1abb54e82e4189847d0bf6c634840c65e0aebfae91f9f207eb9558b068fd7e9752ce287615aae37516e6dd285676861352085242ba9b1496803fbdbd25ceb33b8917bbd8d1f67a0b6a79706595ec07f401179d2bc3ec770c0cb147e4423ffdbcb62af368b597d13d872ae4a22e183211520f794a579ac694123c08f8950d86a2461a68c92039480d55185da92413045221280c21e85a031d1b5c071afb19354eb1a8bb7928d856ad2b9107f14eda79ac80bbc8fbf95b4494318b089a627aeeddb1e7904976d0e54f112ec14b6f9a55d5e229fc4bfe55a8c46205336b1999756e0ea534d110a9855eb31d5ad60f9fb098d104800eb84e6fd4e63ac0df14427607f4409b3ac68c5f8a1628b3a0df9b14e431e1d63216db010fc1c8a6d68ccc42fea15728949597777d89b142457f1c4873827d4fbd25e3fdd6ca6b214bfe0f6d0de5aac364cb125b9cbbc9d15aa8cd00864226cc66512c02d7688a0bce95c14e022210893794f85390aa00f88726c5f52ac2bb47654768f825f16ef7262cddf2e0c0eb8f767b4e95782ddfe33f71ee0dccd17212f5b802efb3e9134ebaa60a12f516f28447101a5c9e3bc17b556a16cbb8e11e137db629f25918abd5c2ae56e2850f91683572a128348859e1cf237dbf3371e0474311d14c8ec8844ce72f12d6ac00c143c42b39e436fc672eeb3efb927ba175574d68ddd46c65554fe3731fb14d5d4428021cf3e37647a851bba26decb50163d93c2d27154cdab5b30df839847c8b7ef99e1740239895c9b3030e1c9d2a005f171b2dc0d04830831ec38f81a579379b7f7e7e5ed6a1131aebb578e23498126999affe1d6127c8ef9815989ce1462f42d6633741baabd17526df8e7c58dea014dcde81efc2b9906a9e086348fdbf6f6be50580b09fbfe9360cc4946c0112030180c01bc44084d4540ea1521c64464e3994ffaece93d944c0955c2c670b5a4086907d39762be1301eaf0b20014d506f3048db14fc7abf35b77b01ed82d48b21c71872a00ce81d1ec9df112cd057bb622387c2e928656dd025b2888cc03517e1d11bc55854c92ad0cb10a8c9baad95008b6d813913cad692465f8ae0c0698b60a67ea417ae30021c27f1fdfee12eb60304b889192a6caa789d08c1aa9db60760865a6d41feb34f788ca3ede5caec27f34755a1a2a9fa357ae2168709e57e5811e38fb59240181a8c3c859abe5bb1ee7cc4c6025ebdd7636678f04284a7cfef30cb2667a3f4a0ac4a0fc6ea547eb389d46c58d7d544fbe0ea1dfef1e08e0ecc72d0e79f0e10d4d5679a9217fe3970e34791d372d1a3242ca95c922ca288ceb672893e2bfc2c8d12be725dd070d45a588a0c7b86253cd69794c23fceaf80fb39612d8035bc0868b7bd64bdc2df446d187886a20d51fe32778979f2f60286208a0142bb41d425d028687d1fa46c5b506222017c2c1e89f1dd21befb1f706f4d14a184c50d0f4ac76759b015dc633c872a03db4b89ea3097667bfabf69e6058cf5924bd0017f3fb1ef7c69860567ccaea78eb17d37983da51acb0c144abb151042f2fafcbcb59dafb1cf52800990765c59c6ccfd9d045e2f8db02f9e99570af7f1526c231e7dfcfbac7a1252cf50651b3fdebcb1d7916711e3d82cae14f3c813ea0128d3939be3db893bde9bdef5427cbbfd78a8744395a5328bd73ca27c53e424508fdbcc8a387be1900b82c9d762929c83a616c5c2c9bb0758ebeb58213a4c0aa23c5b90a03f847fad11698aab03d8fe399ba0fa30a32cd20cdfffd6fe46a4348257dddc3dc6a8a87f901fbb97b5280e0633b7036610d748efd91e1f7eca07971299306532ce04f35e94604c927c45e6474d20dbcf824a7edc35b2303d003967f1355e43b9750d59e12b742b4e0105a42c5f282f0ad706684b61b424d17854d041a5c1cfcb42444e1f6f44fff9975ad4597f3c51d1cebe9b6f03079c37820277c1023c852948e10848aebcb3cc02f893c8c020db44e1738648f1bfc178af7c4d90ecdfe60747eade894dfc9514232b22177497feee32b1c64c6f0bfe7f0b28d870660c959cc5d8e14eb831278ad646fe63e3645ddafb339993a0fba777fbb50e4263828e7eb5dccc3f8ccc117acf3db423d272f88f6b828eb5cb386ce1b94efcf
OPENID_VERIFY_DATA=0x0000000800000023000000160000003e0000008c000000a10000005c00000083000000cf000000f4000001050000004c7b22616c67223a225253323536222c226b6964223a2237633062363931336665313338323061333333333939616365343236653730353335613961306266222c22747970223a224a5754227d000001417b22697373223a2268747470733a2f2f6163636f756e74732e676f6f676c652e636f6d222c22617a70223a223430373430383731383139322e617070732e676f6f676c6575736572636f6e74656e742e636f6d222c22617564223a223430373430383731383139322e617070732e676f6f676c6575736572636f6e74656e742e636f6d222c22737562223a22313035303238373834353536353036383136343431222c2261745f68617368223a22764a7665746b52647878656d4c4c3736355f64325877222c226e6f6e6365223a226e2d3053365f577a41324d6a222c226e6266223a313639343637383139332c22696174223a313639343637383439332c22657870223a313639343638323039332c226a7469223a2231393566366237616531383132616534616364343462653033313562343534376239393230323333227d000001000680b76fb443cbb2533c7d94aab0db30269081a4e3c2be462f0c95559e949e19f7da6548f84493eee3a2ad721be21d96e5ee40f14c346d2917cbbb41dc1c8257940dcaf47c77b766d322a8e778c6cb01a0bcab6b0d1ac31d774e0bbbe61bfcbcf08e6478a48eb1893a633a3b687c68ca766081a976e288a7a81083764917c363fabf952e2482b50760c902c6f3b01863bd1be580c2694eb693cf76f859fa7b2826507ebd49ea0470f7ef617962549b06db5dd3ac486c66191f4a3541ff726c0f5c7bc6f16506d04367e5636e84175bcf59574f715b3a41b5312359ec8f75bdfb2764c6ebef53dac1cdfa94d06afd37d4e1436127c8b57511febe28bb4a5ca1a5
```